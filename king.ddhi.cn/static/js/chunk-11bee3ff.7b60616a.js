(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-11bee3ff"],{"4f8c":function(t,e,a){},"743f":function(t,e,a){"use strict";var i=a("4f8c"),s=a.n(i);s.a},a434:function(t,e,a){"use strict";var i=a("23e7"),s=a("23cb"),l=a("a691"),n=a("50c4"),o=a("7b0b"),r=a("65f0"),u=a("8418"),c=a("1dde"),m=a("ae40"),d=c("splice"),h=m("splice",{ACCESSORS:!0,0:0,1:2}),p=Math.max,f=Math.min,g=9007199254740991,_="Maximum allowed length exceeded";i({target:"Array",proto:!0,forced:!d||!h},{splice:function(t,e){var a,i,c,m,d,h,b=o(this),v=n(b.length),k=s(t,v),D=arguments.length;if(0===D?a=i=0:1===D?(a=0,i=v-k):(a=D-2,i=f(p(l(e),0),v-k)),v+a-i>g)throw TypeError(_);for(c=r(b,i),m=0;m<i;m++)d=k+m,d in b&&u(c,m,b[d]);if(c.length=i,a<i){for(m=k;m<v-i;m++)d=m+i,h=m+a,d in b?b[h]=b[d]:delete b[h];for(m=v;m>v-i+a;m--)delete b[m-1]}else if(a>i)for(m=v-i;m>k;m--)d=m+i-1,h=m+a-1,d in b?b[h]=b[d]:delete b[h];for(m=0;m<a;m++)b[m+k]=arguments[m+2];return b.length=v-i+a,c}})},d334:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"shopSet"},[a("div",{staticClass:"pageTitle"},[t._v(t._s(this._getVuex("pageTitle")))]),a("div",{staticClass:"add-box"},[a("el-button",{attrs:{type:"danger"},on:{click:t.batchDelete}},[t._v("删除")]),a("el-button",{attrs:{type:"success"},on:{click:t.insertItemtk}},[t._v("新增")]),a("el-input",{staticClass:"searchInput",attrs:{placeholder:"请输入要搜索的内容","prefix-icon":"el-icon-search"},on:{change:t.searchDatas},model:{value:t.searchValue,callback:function(e){t.searchValue=e},expression:"searchValue"}})],1),a("div",{staticClass:"shanxdiv"},[a("el-select",{staticStyle:{"margin-right":"10px"},attrs:{placeholder:"请选择状态"},model:{value:t.status,callback:function(e){t.status=e},expression:"status"}},[a("el-option",{key:"0",attrs:{label:"停用",value:"0"}}),a("el-option",{key:"1",attrs:{label:"启用",value:"1"}})],1),a("el-button",{attrs:{type:"primary"},on:{click:t.screening}},[t._v("筛选")]),a("el-button",{attrs:{type:"info"},on:{click:t.resetData}},[t._v("重置")])],1),a("el-table",{ref:"multipNum",staticStyle:{width:"100%"},attrs:{stripe:"",data:t.tableListData,"tooltip-effect":"dark"},on:{"selection-change":t.selectItem}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),a("el-table-column",{attrs:{label:"全选/角色ID",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.id))])]}}])}),a("el-table-column",{attrs:{prop:"name",label:"角色名称",width:"150"}}),a("el-table-column",{attrs:{prop:"commission",label:"提成",width:"150"}}),a("el-table-column",{attrs:{prop:"gift_amount",label:"赠送额度",width:"150"}}),a("el-table-column",{attrs:{label:"员工状态",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{directives:[{name:"show",rawName:"v-show",value:0==e.row.status,expression:"scope.row.status == 0"}]},[t._v("停用")]),a("span",{directives:[{name:"show",rawName:"v-show",value:1==e.row.status,expression:"scope.row.status == 1"}]},[t._v("正常")])]}}])}),a("el-table-column",{attrs:{align:"right",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{size:"mini"},on:{click:function(a){t.openUpdateDialog(e.$index,JSON.parse(JSON.stringify(e.row)),"type")}}},[t._v("修改")]),a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){return t.openDelDialog(e.row)}}},[t._v("删除")])]}}])})],1),a("div",{staticClass:"pagination"},[a("el-pagination",{attrs:{"current-page":t.curPage,"hide-on-single-page":!0,background:"",layout:"prev, pager, next",total:t.total},on:{"current-change":t.pageChange}})],1),a("el-dialog",{attrs:{title:"新增",visible:t.insertDialog},on:{"update:visible":function(e){t.insertDialog=e}}},[a("el-form",{ref:"formName",staticClass:"updateArea",attrs:{model:t.addItem,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"角色名称",prop:"name"}},[a("el-input",{model:{value:t.addItem.name,callback:function(e){t.$set(t.addItem,"name",e)},expression:"addItem.name"}})],1),a("el-form-item",{attrs:{label:"提成",prop:"commission"}},[a("el-input",{model:{value:t.addItem.commission,callback:function(e){t.$set(t.addItem,"commission",e)},expression:"addItem.commission"}}),t._v("(0至99) ")],1),a("el-form-item",{attrs:{label:"赠送额度",prop:"gift_amount"}},[a("el-input",{model:{value:t.addItem.gift_amount,callback:function(e){t.$set(t.addItem,"gift_amount",e)},expression:"addItem.gift_amount"}})],1),a("el-form-item",{attrs:{label:"状态",prop:"status"}},[a("el-switch",{attrs:{"active-color":"#13ce66"},model:{value:t.status_ui,callback:function(e){t.status_ui=e},expression:"status_ui"}})],1),a("el-form-item",{attrs:{label:"是否锁定",prop:"lock"}},[a("el-switch",{attrs:{"active-color":"#13ce66"},model:{value:t.lock_ui,callback:function(e){t.lock_ui=e},expression:"lock_ui"}})],1),a("el-form-item",{attrs:{label:"权限设置"}},[a("el-tree",{ref:"tree",attrs:{data:t.menuData,"show-checkbox":"","node-key":"id","default-expand-all":!0,props:t.defaultProps}})],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.insertDialog=!1}}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:t.insertItem}},[t._v("确定")])],1)],1),a("el-dialog",{attrs:{title:"修改",visible:t.updateDialog},on:{"update:visible":function(e){t.updateDialog=e}}},[a("el-form",{ref:"updateArea",staticClass:"updateArea",attrs:{"label-width":"80px"}},[a("el-form-item",{attrs:{label:"角色名称"}},[a("el-input",{model:{value:t.currenItem.name,callback:function(e){t.$set(t.currenItem,"name",e)},expression:"currenItem.name"}})],1),a("el-form-item",{attrs:{label:"提成"}},[a("el-input",{model:{value:t.currenItem.commission,callback:function(e){t.$set(t.currenItem,"commission",e)},expression:"currenItem.commission"}}),t._v("(0至99) ")],1),a("el-form-item",{attrs:{label:"赠送额度"}},[a("el-input",{model:{value:t.currenItem.gift_amount,callback:function(e){t.$set(t.currenItem,"gift_amount",e)},expression:"currenItem.gift_amount"}})],1),a("el-form-item",{attrs:{label:"状态"}},[a("el-switch",{attrs:{"active-color":"#13ce66"},model:{value:t.status_ui,callback:function(e){t.status_ui=e},expression:"status_ui"}})],1),a("el-form-item",{attrs:{label:"是否锁定"}},[a("el-switch",{attrs:{"active-color":"#13ce66"},model:{value:t.lock_ui,callback:function(e){t.lock_ui=e},expression:"lock_ui"}})],1),a("el-form-item",{attrs:{label:"权限设置"}},[a("el-tree",{ref:"tree",attrs:{data:t.menuData,"show-checkbox":"","node-key":"id","default-expand-all":!0,props:t.defaultProps,"default-checked-keys":t.updateQ}})],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.updateDialog=!1}}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:t.multiUpdate}},[t._v("确定")])],1)],1),a("el-dialog",{attrs:{title:"删除-"+t.currenDeleteRow.name,visible:t.deleteDialog,width:"30%"},on:{"update:visible":function(e){t.deleteDialog=e}}},[a("span",[t._v("确定要删除此项吗")]),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.deleteDialog=!1}}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.deleteItem("one")}}},[t._v("确定")])],1)]),a("el-dialog",{attrs:{title:"删除",visible:t.mutilDeleteDialog,width:"50%"},on:{"update:visible":function(e){t.mutilDeleteDialog=e}}},[a("span",{staticClass:"s-title"},[t._v("确定要删除以下内容吗?")]),t._l(t.nameArr,(function(e,i){return a("div",{key:i,staticClass:"gz-name"},[t._v(" "+t._s(e)+" ")])})),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.mutilDeleteDialog=!1}}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.deleteItem("mutil")}}},[t._v("确定")])],1)],2)],1)},s=[],l=(a("99af"),a("4160"),a("a434"),a("b0c0"),a("a9e3"),a("159b"),{name:"currenPage",data:function(){return{merchants:{shop_id:0,merchant_id:0},status:"",allQL:!1,updateDialog:!1,insertDialog:!1,mutilDeleteDialog:!1,deleteDialog:!1,curPage:1,total:13,rulesForm:{name:[{required:!0,message:"请输入名称",trigger:"blur"}]},tableListData:[],status_ui:!0,lock_ui:!1,addItem:{shop_id:"",merchant_id:"",name:"",commission:"",gift_amount:"",status:1,lock:0,menu_ids:[]},currenItem:{},currenDeleteRow:"",multipleSelection:[],nameArr:[],searchValue:"",defaultProps:{children:"children",label:"label"},menuData:[],updateQ:[]}},created:function(){this.merchants.shop_id=Number(this.$route.query.shop_id),this.merchants.merchant_id=Number(this.$route.query.merchant_id),this.addItem.shop_id=Number(this.$route.query.shop_id),this.addItem.merchant_id=Number(this.$route.query.merchant_id),this.currenItem.merchant_id=Number(this.$route.query.merchant_id),this.currenItem.shop_id=Number(this.$route.query.shop_id),this.getTableList(),this.menuAllTree()},methods:{getCheckedNodes:function(){var t=this.$refs.tree.getCheckedKeys(),e=this.$refs.tree.getHalfCheckedKeys();return""!=e?t.concat(e):t},resetData:function(){this.status="",this.curPage=1,this.getTableList()},screening:function(){this.curPage=1,this.getTableList()},getTableList:function(){var t=this,e={merchant_id:this.merchants.merchant_id,shop_id:this.merchants.shop_id,status:this.status,page:this.curPage,name:this.searchValue};this.api.staff.juesList(e).then((function(e){t.tableListData=e.data.data,t.total=e.data.count}))},menuAllTree:function(){var t=this;this.api.staff.menuAllTree().then((function(e){t.menuData=e.data.data}))},searchDatas:function(){this.curPage=1,this.getTableList()},insertItemtk:function(){this.insertDialog=!0,this.status_ui=!0,this.lock_ui=!1},insertItem:function(){var t=this,e=this.addItem;this.status_ui?e.status=1:e.status=0,this.lock_ui?e.lock=1:e.lock=0,e.menu_ids=this.getCheckedNodes(),e.gift_amount=Number(e.gift_amount),e.commission=Number(e.commission),this.api.staff.juesInsert(e).then((function(e){t.$refs["formName"].resetFields(),t.getTableList(),t.insertDialog=!1}))},openUpdateDialog:function(t,e){this.updateDialog=!0,this.currenItem=e,this.permissionsID(this.currenItem.id),1==this.currenItem.status?this.status_ui=!0:this.status_ui=!1,1==this.currenItem.lock?this.lock_ui=!0:this.lock_ui=!1},permissionsID:function(t){var e=this,a={role_id:t,merchant_id:this.merchants.merchant_id,shop_id:this.merchants.shop_id};this.api.staff.RoleMenuIDList(a).then((function(t){for(var a=t.data.data.menu_id,i=0;i<a.length;i++)if(1==a[i]){a.splice(i,1);break}e.updateQ=a}))},multiUpdate:function(){var t=this,e=this.currenItem;this.status_ui?e.status=1:e.status=0,this.lock_ui?e.lock=1:e.lock=0,e.gift_amount=Number(e.gift_amount),e.commission=Number(e.commission),this.UpdateQ(e.id),this.api.staff.juesUpdate(e).then((function(e){t.getTableList(),t.updateDialog=!1}))},UpdateQ:function(t){var e={role_id:t,menu_ids:this.getCheckedNodes(),merchant_id:this.merchants.merchant_id,shop_id:this.merchants.shop_id};this.api.staff.setRoleMenu(e).then((function(t){}))},batchDelete:function(){""!=this.multipleSelection?this.mutilDeleteDialog=!0:this.$message({message:"请先勾选要删除的数据",type:"warning"})},openDelDialog:function(t){this.currenDeleteRow=t,this.deleteDialog=!0},deleteItem:function(t){var e=this,a=[];"one"==t?a[0]=this.currenDeleteRow.id:"mutil"==t&&(a=this.multipleSelection);var i={id:a,merchant_id:this.merchants.merchant_id,shop_id:this.merchants.shop_id};this.api.staff.juesDelete(i).then((function(t){e.getTableList(),e.mutilDeleteDialog=!1,e.deleteDialog=!1}))},selectItem:function(t){var e=this;this.multipleSelection=[],this.nameArr=[],t.forEach((function(t,a){e.multipleSelection.push(t.id),e.nameArr.push(t.name)}))},pageChange:function(t){this.curPage=t,this.getTableList()}}}),n=l,o=(a("743f"),a("2877")),r=Object(o["a"])(n,i,s,!1,null,"51ec47f1",null);e["default"]=r.exports}}]);
//# sourceMappingURL=chunk-11bee3ff.7b60616a.js.map