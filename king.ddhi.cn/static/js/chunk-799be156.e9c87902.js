(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-799be156"],{"3b89":function(t,e,i){},"3f0e":function(t,e,i){"use strict";var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"image-box"},[t._l(t.file_list,(function(e,a){return i("div",{key:a,staticClass:"img-div",style:t.option.showImageWidth&&t.option.showImageHeight?"width:"+t.option.showImageWidth+"px;height:"+t.option.showImageHeight+"px;":""},[i("img",{staticClass:"d-img",style:t.option.showImageWidth&&t.option.showImageHeight?"width:"+t.option.showImageWidth+"px;height:"+t.option.showImageHeight+"px;":"",attrs:{src:e.url,alt:""},on:{mouseover:function(e){return t.picMouseover(a)},mouseleave:function(e){return t.picMouseleave()},click:function(i){return t.showImg(e.url)}}}),i("div",{directives:[{name:"show",rawName:"v-show",value:t.showBtnIndex==a,expression:"showBtnIndex == index"}],staticClass:"del-icon",on:{click:function(e){return t.deletePotoFun(a)},mouseover:function(e){return t.picMouseover(a)},mouseleave:function(e){return t.picMouseleave()}}},[i("i",{staticClass:"delete-i el-icon-delete"})])])})),i("el-alert",{directives:[{name:"show",rawName:"v-show",value:t.file_list.length>=t.limit,expression:"file_list.length >= limit"}],attrs:{title:"图片数已经到达限制数："+t.limit+"。 请删掉一些图片后才能上传。",type:"warning",closable:!1}}),i("Imgcutter",{directives:[{name:"show",rawName:"v-show",value:t.file_list.length<t.limit,expression:"file_list.length < limit"}],attrs:{boxHeight:t.option.boxHeight,cutWidth:t.option.cutWidth,cutHeight:t.option.cutHeight,sizeChange:t.option.sizeChange,isModal:void 0==t.option.isModal||t.option.isModal},on:{cutDown:t.cutDown}}),i("el-dialog",{attrs:{visible:t.dialogVisible},on:{"update:visible":function(e){t.dialogVisible=e}}},[i("img",{key:t.dialogImageUrl,attrs:{width:"100%",src:t.dialogImageUrl,alt:""}})])],2)},o=[],r=(i("a434"),i("a9e3"),i("5f87")),n={name:"cutterImageUpload",props:{fileList:{type:Array},option:{type:Object},root:{type:String},limit:{type:Number,default:1}},data:function(){return{header:{headers:{"Content-Type":"multipart/form-data; boundary=--------------------------AAAAA",AccessToken:Object(r["a"])()}},loading:!1,file_list:[],showBtnIndex:null,oss_url:this.GetImageOssUrl(),dialogImageUrl:"",dialogVisible:!1}},watch:{fileList:function(t){this.file_list=t||[]}},methods:{showImg:function(t){this.dialogImageUrl=t,this.dialogVisible=!0},picMouseover:function(t){this.showBtnIndex=t},picMouseleave:function(){this.showBtnIndex=null},deletePotoFun:function(t){var e=this;this.$confirm("确定删除吗？").then((function(){e.file_list.splice(t,1),e.$emit("upload",e.file_list)}))},clearAllImage:function(){this.file_list=[]},getAllImage:function(){return this.file_list},cutDown:function(t){var e=this,i=t.file.size/1024/1024<2;if(i){var a=new FormData;a.append("file[]",t.file),a.append("root",this.root),this.$ajax.post("/api/file/uploads",a,this.header).then((function(t){0==t.data.code?(e.file_list.push({url:e.oss_url+t.data.data.url_path[0]}),e.$emit("upload",e.file_list)):e.$message({message:t.data.msg,type:"warning"})}))}else this.$message({message:"上传失败，图片不能大于2M，请重新选择图片",type:"warning"})}}},s=n,l=(i("8234"),i("2877")),u=Object(l["a"])(s,a,o,!1,null,"210a23de",null);e["a"]=u.exports},"51c8":function(t,e,i){},"6cc1":function(t,e,i){"use strict";var a=i("3b89"),o=i.n(a);o.a},"7d19":function(t,e,i){"use strict";var a=i("90b3"),o=i.n(a);o.a},8234:function(t,e,i){"use strict";var a=i("51c8"),o=i.n(a);o.a},"849c":function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"articleOperation"},[i("p",[t._v(t._s(t.title))]),i("div",[i("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:t.formData,rules:t.rules,"label-width":"100px"}},[i("el-form-item",{attrs:{label:"文章标题:",prop:"title"}},[i("el-input",{model:{value:t.formData.title,callback:function(e){t.$set(t.formData,"title",e)},expression:"formData.title"}})],1),i("el-form-item",{attrs:{label:"文章概要:",prop:"summary"}},[i("el-input",{attrs:{type:"textarea",rows:8},model:{value:t.formData.summary,callback:function(e){t.$set(t.formData,"summary",e)},expression:"formData.summary"}})],1),i("el-form-item",{attrs:{label:"封面图:",prop:"image"}},[i("div",{staticClass:"imageType"},[i("uploadFiles",{ref:"uploadImages",staticClass:"uploadTemp",attrs:{limit:1,fileList:t.imageUrl,option:{boxHeigth:600,cutWidth:343,cutHeight:130,sizeChange:!1,showImageWidth:343,showImageHeight:130},root:"goods"},on:{upload:t.uploadTheImages}}),i("el-dialog",{attrs:{visible:t.dialogVisible},on:{"update:visible":function(e){t.dialogVisible=e}}},[i("img",{attrs:{width:"100%",src:t.formData.image}})])],1)])],1),i("editorBar",{staticStyle:{"margin-top":"150px"},attrs:{editorContentData:t.formData.content,root:"article"},on:{editorData:t.getEditorData}}),i("div",{staticStyle:{"margin-top":"20px"}},[i("el-button",{staticStyle:{"margin-right":"20px"},attrs:{type:"primary"},on:{click:function(e){return t.submitForm("ruleForm")}}},[t._v(t._s(t.btnVal))])],1)],1),i("go-back")],1)},o=[],r=(i("a15b"),i("ac1f"),i("1276"),i("c55c")),n=i("3f0e"),s={name:"articleYD",data:function(){return{imageUploadUrl:this.api.articleManage.uploadsImage,imageUrl:[],title:"",formData:{class_id:0,title:"",url:"",image:"",status:1,summary:"",type:2,content:""},rules:{title:[{required:!0,message:"请输入文章标题",trigger:"blur"}],summary:[{required:!0,message:"请输入文章摘要",trigger:"blur"}],url:[{required:!0,message:"请输入文章地址",trigger:"blur"}],sort:[{required:!0,message:"请输入文章排序",trigger:"blur"}],status:[{required:!0,message:"请输入文章状态",trigger:"blur"}]},btnVal:"新增",dialogVisible:!1,imageInit:!1}},components:{editorBar:r["a"],uploadFiles:n["a"]},created:function(){this.$route.query.id?(this.title="编辑文章",this.btnVal="修改",this.imageInit=!0,this.getArticleDetile(this.$route.query.id)):this.title="新增文章"},methods:{uploadTheImages:function(t){var e=[];for(var i in t)e.push(t[i]["url"]);this.formData.image=e.join(",")},getArticleDetile:function(t){var e=this;this.api.articleManage.articleDetail({id:t}).then((function(t){var i=t.data.data,a=i.content,o=i.title,r=i.summary,n=i.url,s=i.image,l=i.article_id,u=i.status,c=i.type;e.formData={content:a,title:o,summary:r,url:n,image:s,article_id:l,status:u,type:c};var d=e.formData.image.split(",");for(var m in e.imageUrl=[],d)e.imageUrl.push({url:d[m]});console.log(e.formData)}))},getEditorData:function(t){this.formData.content=t},beforeAvatarUpload:function(t){return this.imageInit=!1,!0},handleRemove:function(t,e){this.formData.image=null,setTimeout((function(){document.getElementsByClassName("el-upload--picture-card")[0].style.display="inline-block"}),200)},handleSuccess:function(t){this.formData.image=t.data?t.data.url_path[0]:t,document.getElementsByClassName("el-upload--picture-card")[0].style.display="none"},submitForm:function(t){var e=this;this.$refs[t].validate((function(t){if(!t)return console.log("error submit!!"),!1;if(e.$route.query.id){var i=Object.assign({},e.formData);i.image=e.GetImageUrl(i.image),e.api.articleManage.editArticle(i).then((function(t){console.log(t),e.$message.success("修改成功！"),e.$router.push({path:"/articleManage"}),e.$router.back()}))}else e.api.articleManage.addArticle(e.formData).then((function(t){e.$message.success("新增成功！"),e.$router.back()}))}))}}},l=s,u=(i("6cc1"),i("2877")),c=Object(u["a"])(l,a,o,!1,null,null,null);e["default"]=c.exports},"90b3":function(t,e,i){},a15b:function(t,e,i){"use strict";var a=i("23e7"),o=i("44ad"),r=i("fc6a"),n=i("a640"),s=[].join,l=o!=Object,u=n("join",",");a({target:"Array",proto:!0,forced:l||!u},{join:function(t){return s.call(r(this),void 0===t?",":t)}})},a434:function(t,e,i){"use strict";var a=i("23e7"),o=i("23cb"),r=i("a691"),n=i("50c4"),s=i("7b0b"),l=i("65f0"),u=i("8418"),c=i("1dde"),d=i("ae40"),m=c("splice"),h=d("splice",{ACCESSORS:!0,0:0,1:2}),f=Math.max,g=Math.min,p=9007199254740991,v="Maximum allowed length exceeded";a({target:"Array",proto:!0,forced:!m||!h},{splice:function(t,e){var i,a,c,d,m,h,w=s(this),b=n(w.length),y=o(t,b),x=arguments.length;if(0===x?i=a=0:1===x?(i=0,a=b-y):(i=x-2,a=g(f(r(e),0),b-y)),b+i-a>p)throw TypeError(v);for(c=l(w,a),d=0;d<a;d++)m=y+d,m in w&&u(c,d,w[m]);if(c.length=a,i<a){for(d=y;d<b-a;d++)m=d+a,h=d+i,m in w?w[h]=w[m]:delete w[h];for(d=b;d>b-a+i;d--)delete w[d-1]}else if(i>a)for(d=b-a;d>y;d--)m=d+a-1,h=d+i-1,m in w?w[h]=w[m]:delete w[h];for(d=0;d<i;d++)w[d+y]=arguments[d+2];return w.length=b-a+i,c}})},c55c:function(t,e,i){"use strict";var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("el-link",{directives:[{name:"show",rawName:"v-show",value:!t.isHtml&&""!=t.root,expression:"!isHtml && root != ''"}],attrs:{type:"primary"},on:{click:function(e){return t.handleHtml(!0)}}},[t._v("编辑HTML")]),i("el-link",{directives:[{name:"show",rawName:"v-show",value:t.isHtml&&""!=t.root,expression:"isHtml && root != ''"}],attrs:{type:"primary"},on:{click:function(e){return t.handleHtml(!1)}}},[t._v("返回编辑器")]),i("div",{directives:[{name:"show",rawName:"v-show",value:!t.isHtml&&""!=t.root,expression:"!isHtml && root != ''"}],ref:"editorElem"}),i("el-input",{directives:[{name:"show",rawName:"v-show",value:t.isHtml&&""!=t.root,expression:"isHtml && root != ''"}],attrs:{type:"textarea",rows:15,placeholder:"请输入内容"},on:{change:t.handleHtmlChange},model:{value:t.editorContentHtml,callback:function(e){t.editorContentHtml=e},expression:"editorContentHtml"}}),i("h4",{directives:[{name:"show",rawName:"v-show",value:""==this.root,expression:"this.root == ''"}]},[t._v("没有设置路径“root”...")])],1)},o=[],r=i("6fad"),n=i.n(r),s=i("bc3a"),l=i.n(s),u=i("5f87"),c={name:"Editor",data:function(){return{isHtml:!1,editor:null,editorContent:"",editorContentHtml:"",header:{headers:{"Content-Type":"multipart/form-data; boundary=--------------------------AAAAA",AccessToken:Object(u["a"])()}}}},props:{editorContentData:{},root:{type:String,default:""}},watch:{editorContentData:function(t,e){this.editorContent||(this.editorContent=t,this.editor.txt.html(this.editorContent))}},mounted:function(){var t=this;this.editor=new n.a(this.$refs.editorElem),this.editor.config.onchange=function(e){t.editorContent=e,t.catchData(t.editorContent)},this.editor.config.withCredentials=!0,this.editor.config.customUploadImg=function(e,i){var a=new FormData;a.append("file[]",e[0]),a.append("root",t.root);var o="/api/file/uploads";l.a.post(o,a,t.header).then((function(e){var i=e.data,a=i.data.url_path;for(var o in a)t.editor.cmd.do("insertHTML",'<img src="https://files.ddhi.cn'+a[o]+'" style="max-width: 100%;">')}))},this.editor.config.uploadImgMaxSize=3145728,this.editor.config.uploadImgMaxLength=5,this.editor.config.uploadImgShowBase64=!0,this.editor.config.uploadFileName="myFileName",this.editor.config.menus=["head","bold","fontSize","fontName","italic","underline","strikeThrough","foreColor","backColor","link","list","justify","quote","emoticon","image","table","code","undo","redo"],this.editor.create()},methods:{catchData:function(t){this.$emit("editorData",t)},handleHtml:function(t){t&&(this.editorContentHtml=this.editorContent),this.isHtml=t},handleHtmlChange:function(){this.editorContent=this.editorContentHtml,this.editor.txt.html(this.editorContent)}}},d=c,m=(i("7d19"),i("2877")),h=Object(m["a"])(d,a,o,!1,null,null,null);e["a"]=h.exports}}]);
//# sourceMappingURL=chunk-799be156.e9c87902.js.map