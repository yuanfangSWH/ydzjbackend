(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-dae6f3be"],{"542b":function(t,e,i){},e9a5:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{},[i("div",{staticClass:"shopSet"},[i("div",{staticClass:"pageTitle"},[t._v(t._s(this._getVuex("pageTitle")))]),i("div",{staticClass:"shanxdiv"},[i("div",{staticStyle:{flex:"1"}},[0==t.searchOption.is_delete?i("div",[i("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"danger",disabled:!t.multipleSelection.length>0},on:{click:function(e){return t.deleteData(0)}}},[t._v("删除")]),i("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"danger"},on:{click:t.handleNewArticle}},[t._v("新增")]),i("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary"},on:{click:function(e){return t.handleDataDelete(1)}}},[t._v("回收站")])],1):t._e(),1==t.searchOption.is_delete?i("div",[i("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"danger"},on:{click:function(e){return t.handleDataDelete(0)}}},[t._v("返回")]),i("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"danger",disabled:!t.multipleSelection.length>0},on:{click:function(e){return t.recoveryData(0)}}},[t._v("还原")]),i("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"danger",disabled:!t.multipleSelection.length>0},on:{click:function(e){return t.realDelData(0)}}},[t._v("彻底删除")])],1):t._e()]),i("div",{},[i("el-input",{staticStyle:{width:"350px","margin-right":"10px"},attrs:{placeholder:"搜索推送标题",clearable:""},on:{change:t.screening},model:{value:t.searchOption.keyword,callback:function(e){t.$set(t.searchOption,"keyword",e)},expression:"searchOption.keyword"}}),i("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"danger"},on:{click:t.screening}},[t._v("搜索")])],1)]),i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"multipNum",staticStyle:{width:"100%"},attrs:{stripe:"",data:t.tableListData,"tooltip-effect":"dark"},on:{"selection-change":t.selectItem,"sort-change":t.handleDataSort}},[i("el-table-column",{attrs:{type:"selection",width:"55"}}),i("el-table-column",{attrs:{prop:"article_id",label:"ID",width:"80"}}),i("el-table-column",{attrs:{prop:"image",label:"图片",width:"100"},scopedSlots:t._u([{key:"default",fn:function(t){return[i("el-image",{attrs:{src:t.row.image}})]}}])}),i("el-table-column",{attrs:{prop:"title",label:"标题"}}),i("el-table-column",{attrs:{prop:"view_count",label:"浏览量"}}),i("el-table-column",{attrs:{prop:"create_time",label:"发布时间"}}),i("el-table-column",{attrs:{align:"center",label:"操作",width:"200",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[0==t.searchOption.is_delete?i("div",[i("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(i){return t.handlePushArticle(e.row)}}},[t._v("推送")]),i("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(i){return t.handleOpenPush(e.row)}}},[t._v("查看推送")]),i("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(i){return t.handleOpenArticle(e.row.article_id)}}},[t._v("编辑")]),i("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(i){return t.deleteData(e.row.article_id)}}},[t._v("删除")])],1):t._e(),1==t.searchOption.is_delete?i("div",[i("div",[i("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(i){return t.recoveryData(e.row.article_id)}}},[t._v("还原")]),i("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(i){return t.handleOpenPush(e.row)}}},[t._v("查看推送")])],1),i("div",[i("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(i){return t.handleOpenArticle(e.row.article_id)}}},[t._v("编辑")]),i("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(i){return t.realDelData(e.row.article_id)}}},[t._v("彻底删除")])],1)]):t._e()]}}])})],1),i("div",{staticClass:"pagination"},[i("el-pagination",{ref:"pagination",attrs:{"current-page":t.searchOption.page,"hide-on-single-page":!0,background:"",layout:"prev, pager, next",total:t.total},on:{"current-change":t.pageChange}})],1)],1),i("el-dialog",{attrs:{title:"发起推送",visible:t.insertDialog,width:"50%"},on:{"update:visible":function(e){t.insertDialog=e}}},[i("el-form",{ref:"detailsData",staticClass:"demo-ruleForm",attrs:{model:t.detailsData,rules:t.rules,"label-width":"150px"}},[i("el-form-item",{attrs:{label:"推送标题：",prop:"title"}},[i("el-input",{attrs:{placeholder:"请填写推送标题"},model:{value:t.detailsData.title,callback:function(e){t.$set(t.detailsData,"title",e)},expression:"detailsData.title"}})],1),i("el-form-item",{attrs:{label:"推送内容：",prop:"content"}},[i("el-input",{attrs:{type:"textarea",rows:3,placeholder:"请填写推送内容"},model:{value:t.detailsData.content,callback:function(e){t.$set(t.detailsData,"content",e)},expression:"detailsData.content"}})],1),i("el-form-item",{attrs:{label:"链接",prop:"url"}},[i("el-input",{attrs:{placeholder:"请填写推送标题"},model:{value:t.detailsData.url,callback:function(e){t.$set(t.detailsData,"url",e)},expression:"detailsData.url"}})],1),i("el-form-item",{attrs:{label:"全体推送",prop:"target"}},[i("el-switch",{attrs:{"active-value":"1","inactive-value":"2"},model:{value:t.detailsData.target,callback:function(e){t.$set(t.detailsData,"target",e)},expression:"detailsData.target"}})],1),"2"==t.detailsData.target?i("el-form-item",{attrs:{label:"指定性别："}},[i("el-checkbox-group",{model:{value:t.target_sex,callback:function(e){t.target_sex=e},expression:"target_sex"}},[i("el-checkbox",{attrs:{label:"男"}}),i("el-checkbox",{attrs:{label:"女"}})],1)],1):t._e(),"2"==t.detailsData.target?i("el-form-item",{attrs:{label:"指定系统："}},[i("el-checkbox-group",{model:{value:t.target_os,callback:function(e){t.target_os=e},expression:"target_os"}},[i("el-checkbox",{attrs:{label:"iOS"}}),i("el-checkbox",{attrs:{label:"Android"}})],1)],1):t._e(),i("el-form-item",{attrs:{label:"计划时间："}},[i("el-date-picker",{attrs:{type:"datetime",placeholder:"设置计划推送时间","value-format":"yyyy-MM-dd HH:mm",format:"yyyy-MM-dd HH:mm"},model:{value:t.detailsData.send_time,callback:function(e){t.$set(t.detailsData,"send_time",e)},expression:"detailsData.send_time"}}),t._v(" 注：不填则立即推送 ")],1)],1),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){t.insertDialog=!1}}},[t._v("取消")]),i("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.handleInsertData("detailsData")}}},[t._v("确定")])],1)],1)],1)},r=[],l=(i("4160"),i("b0c0"),i("a9e3"),i("159b"),i("2ef0"),{name:"SystemYD",data:function(){return{searchOption:{keyword:"",sort:"",order:"",page:1,start_time:"",end_time:"",is_delete:0},multipleSelection:[],searchTime:["",""],detailsDialog:!1,insertDialog:!1,total:1,tableListData:[],articleData:{article_id:0,class_id:0,class_name:"",content:"",create_time:"",delete_time:"",image:"",modify_time:"",status:0,summary:"",title:"",type:0,url:"",view_count:0},detailsData:{push_id:"",title:"",content:"",image:"",url:"",target:"1",target_sex:0,target_os:0,target_ver:"",send_time:"",article_id:0},target_sex:[],target_os:[],rules:{title:[{required:!0,message:"请输入推送标题",trigger:"blur"}],content:[{required:!0,message:"请输入推送内容",trigger:"blur"}],url:[{required:!0,message:"请输入链接",trigger:"blur"}]},loading:!1,sortableList:{ascending:"asc",descending:"desc",asc:"ascending",desc:"descending"},pickerOptions:{shortcuts:[{text:"最近一周",onClick:function(t){var e=new Date,i=new Date;i.setTime(i.getTime()-6048e5),t.$emit("pick",[i,e])}},{text:"最近一个月",onClick:function(t){var e=new Date,i=new Date;i.setTime(i.getTime()-2592e6),t.$emit("pick",[i,e])}},{text:"最近三个月",onClick:function(t){var e=new Date,i=new Date;i.setTime(i.getTime()-7776e6),t.$emit("pick",[i,e])}}]}}},created:function(){this.iniPageParam(),this.getTableList()},watch:{$route:function(t,e){this.iniPageParam(),this.getTableList()}},methods:{iniPageParam:function(){this.searchOption={keyword:this.$route.query.keyword?decodeURIComponent(this.$route.query.keyword):"",user:this.$route.query.user,sort:this.$route.query.sort,order:this.$route.query.order,page:this.$route.query.page?Number(this.$route.query.page):1,start_time:this.$route.query.start_time,end_time:this.$route.query.end_time,is_delete:this.$route.query.is_delete?Number(this.$route.query.is_delete):0},this.searchTime[0]=this.$route.query.start_time?this.$route.query.start_time:"",this.searchTime[1]=this.$route.query.end_time?this.$route.query.end_time:""},selectItem:function(t){var e=this;this.multipleSelection=[],this.nameArr=[],t.forEach((function(t,i){e.multipleSelection.push(t.article_id),e.nameArr.push(t.name)}))},insertData:function(){this.insertDialog=!0},handleDataSort:function(t){this.searchOption.sort=t.order?t.prop:"",this.searchOption.order=t.order?this.sortableList[t.order]:"",this.searchOption.page=1,this.pageChange()},handleNewArticle:function(){this.$router.push({path:"/Notification/systemYD/articleYD"})},handleOpenArticle:function(t){this.$router.push({path:"/Notification/systemYD/articleYD",query:{id:t}})},handleInsertData:function(t){var e=this;this.$refs[t].validate((function(i){if(!i)return console.log("error submit!!"),!1;e.$confirm("确定要提交推送吗？","提示").then((function(){e.insertDataOk(t)}))}))},insertDataOk:function(t){var e=this,i=!0,a="";if("2"==this.detailsData.target&&(0==this.target_sex.length?(i=!1,a="必须至少指定一个性别"):0==this.target_os.length?(i=!1,a="必须至少指定一个系统"):(1==this.target_sex.length?this.detailsData.target_sex="男"==this.target_sex[0]?"1":"2":this.detailsData.target_sex="0",1==this.target_os.length?this.detailsData.target_os="iOS"==this.target_os[0]?"1":"2":this.detailsData.target_os="0")),i){var r=this.detailsData;delete r.push_id,delete r.image,r.target=Number(this.detailsData.target),r.target_sex=Number(this.detailsData.target_sex),r.target_os=Number(this.detailsData.target_os),this.api.system.SystemPushInsert(r).then((function(t){var i=t.data,a=i;e.$message({message:""+a.msg,type:"success"}),e.$router.push({path:"/Notification/systemYD"}),e.insertDialog=!1}))}else this.$message.error(a)},dateChange:function(t){t&&(this.searchOption.start_time=t[0],this.searchOption.end_time=t[1])},handleDataDelete:function(t){this.searchOption={keyword:"",sort:"",order:"",page:1,start_time:"",end_time:"",is_delete:t},this.searchTime=[],this.pageChange()},resetData:function(){this.searchOption={keyword:"",sort:"",order:"",page:1,start_time:"",end_time:"",is_delete:0},this.searchTime=[],this.pageChange()},screening:function(){this.searchOption.page=1,this.pageChange()},getTableList:function(){var t=this,e=this.searchOption;e.type=2,this.loading=!0,this.api.articleManage.articleList(e).then((function(e){t.loading=!1,t.tableListData=e.data.data,t.total=e.data.count,t.$refs.pagination.internalCurrentPage=t.searchOption.page}))},deleteData:function(t){Number(t)>0&&(this.multipleSelection=[],this.multipleSelection.push(t),this.$refs.multipNum.clearSelection()),this.multipleSelection.length>0?this.deleteConfirm():this.$message.error("请勾选数据")},deleteConfirm:function(){var t=this;this.multipleSelection.length>0&&this.$confirm("确定要删除吗？","提示").then((function(){var e={id:t.multipleSelection};t.api.articleManage.delArticle(e).then((function(e){e.data;t.getTableList()}))})).catch((function(){}))},recoveryData:function(t){Number(t)>0&&(this.multipleSelection=[],this.multipleSelection.push(t),this.$refs.multipNum.clearSelection()),this.multipleSelection.length>0?this.recoveryDataConfirm():this.$message.error("请勾选数据")},recoveryDataConfirm:function(){var t=this;this.multipleSelection.length>0&&this.$confirm("确定要还原吗？","提示").then((function(){var e={id:t.multipleSelection};t.api.articleManage.recoveryArticle(e).then((function(e){e.data;t.getTableList()}))})).catch((function(){}))},realDelData:function(t){Number(t)>0&&(this.multipleSelection=[],this.multipleSelection.push(t),this.$refs.multipNum.clearSelection()),this.multipleSelection.length>0?this.realDelDataConfirm():this.$message.error("请勾选数据")},realDelDataConfirm:function(){var t=this;this.multipleSelection.length>0&&this.$confirm("确定要彻底删除吗？","提示").then((function(){var e={id:t.multipleSelection};t.api.articleManage.realDelArticle(e).then((function(e){e.data;t.getTableList()}))})).catch((function(){}))},pageChange:function(t){t&&(this.searchOption.page=t);var e=Object.assign({},this.searchOption);e.keyword=e.keyword?encodeURIComponent(e.keyword):"",this.$router.push({path:"/Notification/systemYD",query:e})},handlePushArticle:function(t){this.articleData=t,this.detailsData.title=t.title,this.detailsData.content=t.summary,this.detailsData.image=t.image,this.detailsData.url="http://m.ddhi.cn/single/article/detail?article_id="+t.article_id,this.detailsData.article_id=Number(t.article_id),this.insertDialog=!0},handleOpenPush:function(t){this.$router.push({path:"/Notification/systemPush",query:{article_id:t.article_id}})}}}),n=l,s=(i("eb1c"),i("2877")),o=Object(s["a"])(n,a,r,!1,null,"661daf90",null);e["default"]=o.exports},eb1c:function(t,e,i){"use strict";var a=i("542b"),r=i.n(a);r.a}}]);
//# sourceMappingURL=chunk-dae6f3be.288c43cd.js.map