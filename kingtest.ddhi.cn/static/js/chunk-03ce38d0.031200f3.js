(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-03ce38d0"],{"14d3":function(e,t,r){"use strict";var o=r("97cb"),i=r.n(o);i.a},"4d7e":function(e,t,r){},"97cb":function(e,t,r){},"9cca":function(e,t,r){"use strict";var o=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"uploadFiles"},[r("el-upload",{directives:[{name:"show",rawName:"v-show",value:""!=this.root,expression:"this.root != ''"}],staticClass:"avatar-uploader",attrs:{action:"/api/file/uploads","show-file-list":!1,"file-list":e.fileList,limit:1,"http-request":e.uploadImg,"on-change":e.handleChange,"before-upload":e.beforeAvatarUpload}},[e.imageUrl?r("img",{staticClass:"avatar",attrs:{src:e.imageUrl}}):r("i",{staticClass:"el-icon-plus avatar-uploader-icon"})]),r("h4",{directives:[{name:"show",rawName:"v-show",value:""==this.root,expression:"this.root == ''"}]},[e._v("没有设置路径“root”...")])],1)},i=[],a=(r("a9e3"),r("d3b7"),r("3ca3"),r("ddb0"),r("2b3d"),r("5f87")),l={name:"uploadImg",props:{defaltIcon:Number,root:{type:String,default:""}},data:function(){return{header:{headers:{"Content-Type":"multipart/form-data; boundary=--------------------------AAAAA",AccessToken:Object(a["a"])()}},fileList:[],DataImg:[],imageUrl:""}},methods:{concert:function(e){this.imageUrl=e},beforeAvatarUpload:function(e){var t=e.size/1024/1024<2;return t||this.$message.error("上传图片大小不能超过 2MB!"),t},handleChange:function(e,t){console.log(e.size);var r=e.size/1024/1024<2;console.log(e.size/1024/1024),console.log(e.size/1024/1024<2),r?(this.DataImg=e.raw,this.imageUrl=URL.createObjectURL(e.raw)):(this.fileList=[],this.DataImg=[])},uploadImg:function(e){var t=this,r=new FormData;r.append("file[]",this.DataImg),r.append("root",this.root),this.$ajax.post("/api/file/uploads",r,this.header).then((function(e){0==e.data.code?(t.fileList=[],t.DataImg=[],t.$emit("theIMG",e.data.data.url_path[0],t.defaltIcon)):(t.fileList=[],t.DataImg=[],t.imageUrl="",t.$message({message:e.data.msg,type:"warning"}))}))}}},s=l,n=(r("14d3"),r("2877")),c=Object(n["a"])(s,o,i,!1,null,null,null);t["a"]=c.exports},a15b:function(e,t,r){"use strict";var o=r("23e7"),i=r("44ad"),a=r("fc6a"),l=r("a640"),s=[].join,n=i!=Object,c=l("join",",");o({target:"Array",proto:!0,forced:n||!c},{join:function(e){return s.call(a(this),void 0===e?",":e)}})},a434:function(e,t,r){"use strict";var o=r("23e7"),i=r("23cb"),a=r("a691"),l=r("50c4"),s=r("7b0b"),n=r("65f0"),c=r("8418"),u=r("1dde"),m=r("ae40"),d=u("splice"),p=m("splice",{ACCESSORS:!0,0:0,1:2}),h=Math.max,_=Math.min,g=9007199254740991,f="Maximum allowed length exceeded";o({target:"Array",proto:!0,forced:!d||!p},{splice:function(e,t){var r,o,u,m,d,p,b=s(this),k=l(b.length),v=i(e,k),F=arguments.length;if(0===F?r=o=0:1===F?(r=0,o=k-v):(r=F-2,o=_(h(a(t),0),k-v)),k+r-o>g)throw TypeError(f);for(u=n(b,o),m=0;m<o;m++)d=v+m,d in b&&c(u,m,b[d]);if(u.length=o,r<o){for(m=v;m<k-o;m++)d=m+o,p=m+r,d in b?b[p]=b[d]:delete b[p];for(m=k;m>k-o+r;m--)delete b[m-1]}else if(r>o)for(m=k-o;m>v;m--)d=m+o-1,p=m+r-1,d in b?b[p]=b[d]:delete b[p];for(m=0;m<r;m++)b[m+v]=arguments[m+2];return b.length=k-o+r,u}})},b81b:function(e,t,r){"use strict";r.r(t);var o=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"shopSet"},[r("div",{staticClass:"page-title"},[e._v(e._s(this._getVuex("pageTitle")))]),r("div",{staticClass:"formBox"},[r("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"130px"}},[r("el-form-item",{attrs:{label:"套餐名称",prop:"title"}},[r("el-input",{staticClass:"gb-ipt",attrs:{placeholder:"请输入套餐名"},model:{value:e.ruleForm.title,callback:function(t){e.$set(e.ruleForm,"title",t)},expression:"ruleForm.title"}})],1),r("el-form-item",{attrs:{label:"副标题",prop:"subtitle"}},[r("el-input",{staticClass:"gb-ipt",attrs:{placeholder:"请输入套餐副标题"},model:{value:e.ruleForm.subtitle,callback:function(t){e.$set(e.ruleForm,"subtitle",t)},expression:"ruleForm.subtitle"}})],1),r("el-form-item",{attrs:{label:"套餐原价",prop:"original_price"}},[r("el-input",{staticClass:"gb-ipt",attrs:{placeholder:"请输入套餐原价"},model:{value:e.ruleForm.original_price,callback:function(t){e.$set(e.ruleForm,"original_price",t)},expression:"ruleForm.original_price"}})],1),r("el-form-item",{attrs:{label:"套餐价格",prop:"total_price"}},[r("el-input",{staticClass:"gb-ipt",attrs:{placeholder:"请输入套餐价格"},model:{value:e.ruleForm.total_price,callback:function(t){e.$set(e.ruleForm,"total_price",t)},expression:"ruleForm.total_price"}})],1),r("el-form-item",{attrs:{label:"时间段",required:""}},[r("div",{staticClass:"timeBox"},[r("el-time-picker",{attrs:{"picker-options":{selectableRange:"00:00:00 - 23:59:59"},placeholder:"任意时间点","value-format":"HH:mm"},model:{value:e.ruleForm.start_time,callback:function(t){e.$set(e.ruleForm,"start_time",t)},expression:"ruleForm.start_time"}}),r("span",{staticClass:"time-span"},[e._v("-")]),r("el-time-picker",{attrs:{"picker-options":{selectableRange:"00:00:00 - 23:59:59"},placeholder:"任意时间点","value-format":"HH:mm"},model:{value:e.ruleForm.end_time,callback:function(t){e.$set(e.ruleForm,"end_time",t)},expression:"ruleForm.end_time"}})],1)]),r("el-form-item",{attrs:{label:"使用时长",prop:"max_duration"}},[r("el-input",{staticClass:"gb-ipt",attrs:{placeholder:"请输入使用时长"},model:{value:e.ruleForm.max_duration,callback:function(t){e.$set(e.ruleForm,"max_duration",t)},expression:"ruleForm.max_duration"}}),r("span",{staticClass:"uni-span"},[e._v("小时")])],1),r("el-form-item",{attrs:{label:"包厢类型",prop:"type_id"}},[r("el-select",{attrs:{placeholder:"请选择包厢类型"},model:{value:e.ruleForm.type_id,callback:function(t){e.$set(e.ruleForm,"type_id",t)},expression:"ruleForm.type_id"}},e._l(e.options,(function(e,t){return r("el-option",{key:t,attrs:{label:e.name,value:e.type_id}})})),1)],1),r("el-form-item",{attrs:{label:"开放日期",prop:"week_price"}},e._l(e.ruleForm.week_price,(function(t,o){return r("div",{key:o,staticClass:"checkBoxnav"},[1==t.week?r("div",[r("el-checkbox",{attrs:{"v-model":t.checked},on:{change:function(t){return e.checkboxFun(o)}}},[e._v("周一")])],1):e._e(),2==t.week?r("div",[r("el-checkbox",{attrs:{"v-model":t.checked},on:{change:function(t){return e.checkboxFun(o)}}},[e._v("周二")])],1):e._e(),3==t.week?r("div",[r("el-checkbox",{attrs:{"v-model":t.checked},on:{change:function(t){return e.checkboxFun(o)}}},[e._v("周三")])],1):e._e(),4==t.week?r("div",[r("el-checkbox",{attrs:{"v-model":t.checked},on:{change:function(t){return e.checkboxFun(o)}}},[e._v("周四")])],1):e._e(),5==t.week?r("div",[r("el-checkbox",{attrs:{"v-model":t.checked},on:{change:function(t){return e.checkboxFun(o)}}},[e._v("周五")])],1):e._e(),6==t.week?r("div",[r("el-checkbox",{attrs:{"v-model":t.checked},on:{change:function(t){return e.checkboxFun(o)}}},[e._v("周六")])],1):e._e(),7==t.week?r("div",[r("el-checkbox",{attrs:{"v-model":t.checked},on:{change:function(t){return e.checkboxFun(o)}}},[e._v("周日")])],1):e._e(),r("div",{staticClass:"mar-num"},[r("el-input",{staticClass:"price-ipt",attrs:{placeholder:"金额"},model:{value:e.ruleForm.week_price[o].price,callback:function(t){e.$set(e.ruleForm.week_price[o],"price",t)},expression:"ruleForm.week_price[index].price"}})],1),r("span",{staticClass:"t-01"},[e._v("元")]),r("div",{staticClass:"mar-num"},[r("el-input",{staticClass:"price-ipt",attrs:{placeholder:"份数"},model:{value:e.ruleForm.week_price[o].allow_buy,callback:function(t){e.$set(e.ruleForm.week_price[o],"allow_buy",t)},expression:"ruleForm.week_price[index].allow_buy"}})],1),r("span",{staticClass:"t-01"},[e._v("份")])])})),0),r("el-form-item",{attrs:{label:"套餐组合",prop:"goods_detail"}},e._l(e.ruleForm.goods_detail,(function(t,o){return r("div",{key:o,staticClass:"groupBox"},[r("el-autocomplete",{staticClass:"inline-input",attrs:{"fetch-suggestions":e.querySearch,placeholder:"请输入商品名称","trigger-on-focus":!1},on:{select:e.handleSelect,input:function(t){return e.inputFun(o)}},model:{value:e.ruleForm.goods_detail[o].goods_name,callback:function(t){e.$set(e.ruleForm.goods_detail[o],"goods_name",t)},expression:"ruleForm.goods_detail[i].goods_name"}}),r("div",[r("el-input-number",{staticClass:"num-ipt",attrs:{"controls-position":"right",min:1},on:{change:e.handleChange},model:{value:e.ruleForm.goods_detail[o].goods_num,callback:function(t){e.$set(e.ruleForm.goods_detail[o],"goods_num",t)},expression:"ruleForm.goods_detail[i].goods_num"}})],1),r("el-input",{staticClass:"danwei-ipt",attrs:{placeholder:"单位"},model:{value:e.ruleForm.goods_detail[o].goods_unit,callback:function(t){e.$set(e.ruleForm.goods_detail[o],"goods_unit",t)},expression:"ruleForm.goods_detail[i].goods_unit"}}),r("el-input",{staticClass:"danwei-ipt",attrs:{placeholder:"金额"},model:{value:e.ruleForm.goods_detail[o].goods_price,callback:function(t){e.$set(e.ruleForm.goods_detail[o],"goods_price",t)},expression:"ruleForm.goods_detail[i].goods_price"}}),r("span",[e._v("元")]),o==e.ruleForm.goods_detail.length-1?r("i",{staticClass:"add-icon el-icon-circle-plus",on:{click:function(t){return e.addGoodsDetail(o)}}}):r("i",{staticClass:"close-icon el-icon-error",on:{click:function(t){return e.removeGoodsDetail(o)}}})],1)})),0),r("el-form-item",{attrs:{label:"套餐组合",prop:"image"}},[r("uploadFiles",{ref:"uploadImg",attrs:{root:"goods"},on:{theIMG:e.theIMG}}),r("span",{staticClass:"zhushi"},[e._v("（请上传100*100的图片尺寸，不得超过2M，不得超过6张）")])],1),r("el-form-item",{attrs:{label:"购买须知",prop:"summary"}},e._l(e.ruleForm.summary,(function(t,o){return r("div",{key:o,staticClass:"groupBox"},[r("el-input",{staticClass:"n-ipt2",attrs:{placeholder:"请输入小标题"},model:{value:e.ruleForm.summary[o].item_name,callback:function(t){e.$set(e.ruleForm.summary[o],"item_name",t)},expression:"ruleForm.summary[i].item_name"}}),r("el-input",{staticClass:"danwei-ipt2",attrs:{placeholder:"请输入内容"},model:{value:e.ruleForm.summary[o].item_content,callback:function(t){e.$set(e.ruleForm.summary[o],"item_content",t)},expression:"ruleForm.summary[i].item_content"}}),o==e.ruleForm.summary.length-1?r("i",{staticClass:"add-icon el-icon-circle-plus",on:{click:function(t){return e.addSummary(o)}}}):r("i",{staticClass:"close-icon el-icon-error",on:{click:function(t){return e.removeSummary(o)}}})],1)})),0),r("el-form-item",[r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("ruleForm")}}},[e._v("保存")]),r("el-button",{on:{click:function(t){return e.resetForm("ruleForm")}}},[e._v("重置")])],1)],1)],1)])},i=[],a=(r("4de4"),r("a15b"),r("d81d"),r("a434"),r("b0c0"),r("a9e3"),r("9cca")),l=r("2ef0"),s=r.n(l),n={name:"addGroupBuy",components:{uploadFiles:a["a"]},data:function(){return{ruleForm:{shop_id:0,merchant_id:0,title:"",subtitle:"",original_price:"",total_price:"",image:"",images:1,type_id:"",type_name:"",start_time:"",end_time:"",max_duration:"",week_price:[{week:1,price:"",allow_buy:"",checked:!1},{week:2,price:"",allow_buy:"",checked:!1},{week:3,price:"",allow_buy:"",checked:!1},{week:4,price:"",allow_buy:"",checked:!1},{week:5,price:"",allow_buy:"",checked:!1},{week:6,price:"",allow_buy:"",checked:!1},{week:7,price:"",allow_buy:"",checked:!1}],goods_detail:[{goods_name:"",goods_num:1,goods_unit:"",goods_price:""}],summary:[{item_name:"",item_content:""}]},rules:{title:[{required:!0,message:"请输入套餐名称",trigger:"blur"}],original_price:[{required:!0,message:"请输入套餐原价",trigger:"blur"}],total_price:[{required:!0,message:"请输入套餐价格",trigger:"blur"}],type_id:[{required:!0,message:"请选择包厢类型",trigger:"change"}],goods_detail:[{required:!0,message:"请输入套餐组合信息",trigger:"blur"}],image:[{required:!0,message:"请上传套餐图片",trigger:"on-change"}],summary:[{required:!0,message:"请填写购买须知",trigger:"blur"}],week_price:[{required:!0,message:"请选择预定星期",trigger:"change"}],start_time:[{required:!0,message:"请选择开始时间",trigger:"change"}],end_time:[{required:!0,message:"请选择结束时间",trigger:"change"}],max_duration:[{required:!0,message:"请输入使用时长",trigger:"blur"}]},limit:6,restaurants:[],options:[],checked:!1}},created:function(){this.ruleForm.shop_id=Number(this.$route.query.shop_id),this.ruleForm.merchant_id=Number(this.$route.query.merchant_id),this.getGoodsClass()},methods:{checkboxFun:function(e){for(var t=0;t<this.ruleForm.week_price.length;t++)t==e&&(this.ruleForm.week_price[t].checked=!this.ruleForm.week_price[t].checked)},timeFun:function(e){this.ruleForm.allow_hours=e.join("-")},querySearch:function(e,t){var r=this.restaurants;t(r)},handleSelect:function(e){},inputFun:function(e){var t=this,r={name:this.ruleForm.goods_detail[e].goods_name,merchant_id:this.ruleForm.merchant_id,shop_id:this.ruleForm.shop_id};this.$store.dispatch("goods/getGroupBuySelectGoods",r).then((function(e){var r=[];e.data.map((function(e){r.push({value:e.name})})),t.restaurants=r}))},handleChange:function(e){console.log(e)},submitForm:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return console.log("error submit!!"),!1;var r=s.a.cloneDeep(t.ruleForm);r.original_price=100*Number(r.original_price),r.total_price=100*Number(r.total_price);for(var o=0;o<r.goods_detail.length;o++)r.goods_detail[o].goods_price=100*Number(r.goods_detail[o].goods_price);for(o=0;o<r.week_price.length;o++)0==r.week_price[o].checked?delete r.week_price[o]:(delete r.week_price[o].checked,r.week_price[o].price=100*Number(r.week_price[o].price),r.week_price[o].allow_buy=Number(r.week_price[o].allow_buy));r.week_price=r.week_price.filter(Boolean);for(o=0;o<t.options.length;o++)t.options[o].type_id==r.type_id&&(r.type_name=t.options[o].name);r.max_duration=Number(r.max_duration),t.$store.dispatch("goods/addGroupBuy",r).then((function(e){t.$message({message:""+e.msg,type:"success"}),t.$router.push({path:"/ShopInfo",query:{merchant_id:t.ruleForm.merchant_id,shop_id:t.ruleForm.shop_id,tab:"shopGroups"}})}))}))},resetForm:function(e){this.$refs[e].resetFields()},theIMG:function(e){this.ruleForm.image=e},addGoodsDetail:function(e){this.ruleForm.goods_detail.push({goods_name:"",goods_num:1,goods_unit:"",goods_price:""})},removeGoodsDetail:function(e){this.ruleForm.goods_detail.splice(e,1)},getGoodsClass:function(){var e=this,t={merchant_id:this.ruleForm.merchant_id,shop_id:this.ruleForm.shop_id};this.api.shop.getPlaceType(t).then((function(t){e.options=t.data.data}))},addSummary:function(e){this.ruleForm.summary.push({item_name:"",item_content:""})},removeSummary:function(e){this.ruleForm.summary.splice(e,1)}}},c=n,u=(r("f84d"),r("2877")),m=Object(u["a"])(c,o,i,!1,null,"46078855",null);t["default"]=m.exports},f84d:function(e,t,r){"use strict";var o=r("4d7e"),i=r.n(o);i.a}}]);
//# sourceMappingURL=chunk-03ce38d0.031200f3.js.map