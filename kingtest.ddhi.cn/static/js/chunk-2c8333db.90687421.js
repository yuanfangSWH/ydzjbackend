(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2c8333db"],{5204:function(t,e,a){"use strict";var i=a("787d"),s=a.n(i);s.a},7750:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{},[a("div",{staticClass:"shopSet"},[a("div",{staticClass:"pageTitle"},[t._v(t._s(this._getVuex("pageTitle")))]),0==t.searchOption.article_id?a("div",{staticClass:"shanxdiv"},[a("div",{staticClass:"rucwz2"},[t._v("标题")]),a("el-input",{staticStyle:{width:"350px","margin-right":"10px"},attrs:{placeholder:"搜索推送标题",clearable:""},on:{change:t.screening},model:{value:t.searchOption.title,callback:function(e){t.$set(t.searchOption,"title",e)},expression:"searchOption.title"}}),a("div",{staticClass:"rucwz2"},[t._v("推送时间")]),a("el-date-picker",{staticClass:"datePicker",attrs:{type:"datetimerange","picker-options":t.pickerOptions,"range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",align:"right","value-format":"yyyy-MM-dd HH:mm",format:"yyyy-MM-dd HH:mm"},on:{change:t.dateChange},model:{value:t.searchTime,callback:function(e){t.searchTime=e},expression:"searchTime"}}),a("el-button",{staticClass:"filter-btn",staticStyle:{"margin-left":"10px"},attrs:{type:"primary"},on:{click:t.screening}},[t._v("筛选")]),a("el-button",{staticClass:"filter-btn",attrs:{type:"primary"},on:{click:t.resetData}},[t._v("清空条件")])],1):t._e(),t.searchOption.article_id>0?a("div",{staticClass:"shanxdiv"},[a("el-button",{staticClass:"filter-btn",attrs:{type:"primary"},on:{click:function(e){return t.$router.back()}}},[t._v("返回")])],1):t._e()]),a("div",{staticClass:"shopSet"},[0==t.searchOption.article_id?a("div",{staticClass:"shanxdiv"},[a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary"},on:{click:t.insertData}},[t._v("发起推送")])],1):t._e(),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"multipNum",staticStyle:{width:"100%"},attrs:{stripe:"",data:t.tableListData,"tooltip-effect":"dark"},on:{"sort-change":t.handleDataSort}},[a("el-table-column",{attrs:{prop:"push_id",label:"ID",width:"80",sortable:"true"}}),a("el-table-column",{attrs:{prop:"title",label:"推送标题"}}),a("el-table-column",{attrs:{prop:"content",label:"推送内容"}}),a("el-table-column",{attrs:{prop:"url",label:"链接"}}),a("el-table-column",{attrs:{prop:"target",label:"发送到用户"},scopedSlots:t._u([{key:"default",fn:function(e){return[1==e.row.target?a("span",[t._v("全体用户")]):t._e(),2==e.row.target&&0==e.row.target_os?a("span",{staticStyle:{"margin-right":"10px"}},[t._v("不限系统")]):t._e(),2==e.row.target&&1==e.row.target_os?a("span",{staticStyle:{"margin-right":"10px"}},[t._v("iOS")]):t._e(),2==e.row.target&&2==e.row.target_os?a("span",{staticStyle:{"margin-right":"10px"}},[t._v("Android")]):t._e(),2==e.row.target&&0==e.row.target_sex?a("span",{staticStyle:{"margin-right":"10px"}},[t._v("不限性别")]):t._e(),2==e.row.target&&1==e.row.target_sex?a("span",{staticStyle:{"margin-right":"10px"}},[t._v("男用户")]):t._e(),2==e.row.target&&2==e.row.target_sex?a("span",{staticStyle:{"margin-right":"10px"}},[t._v("女用户")]):t._e()]}}])}),a("el-table-column",{attrs:{prop:"send_time",label:"计划推送时间",sortable:"true"}}),a("el-table-column",{attrs:{prop:"push_time",label:"推送时间",sortable:"true"}}),a("el-table-column",{attrs:{prop:"status",label:"状态"},scopedSlots:t._u([{key:"default",fn:function(e){return[0==e.row.status?a("span",[t._v("已删除")]):t._e(),1==e.row.status?a("span",{staticStyle:{color:"#67c23a"}},[t._v("已推送")]):t._e(),2==e.row.status?a("span",[t._v("待推送")]):t._e(),3==e.row.status?a("span",[t._v("取消推送")]):t._e()]}}])})],1),a("div",{staticClass:"pagination"},[a("el-pagination",{ref:"pagination",attrs:{"current-page":t.searchOption.page,"hide-on-single-page":!0,background:"",layout:"prev, pager, next",total:t.total},on:{"current-change":t.pageChange}})],1)],1),a("el-dialog",{attrs:{title:"发起推送",visible:t.insertDialog,width:"50%"},on:{"update:visible":function(e){t.insertDialog=e}}},[a("el-form",{ref:"detailsData",staticClass:"demo-ruleForm",attrs:{model:t.detailsData,rules:t.rules,"label-width":"150px"}},[a("el-form-item",{attrs:{label:"推送标题：",prop:"title"}},[a("el-input",{attrs:{placeholder:"请填写推送标题"},model:{value:t.detailsData.title,callback:function(e){t.$set(t.detailsData,"title",e)},expression:"detailsData.title"}})],1),a("el-form-item",{attrs:{label:"推送内容：",prop:"content"}},[a("el-input",{attrs:{type:"textarea",rows:3,placeholder:"请填写推送内容"},model:{value:t.detailsData.content,callback:function(e){t.$set(t.detailsData,"content",e)},expression:"detailsData.content"}})],1),a("el-form-item",{attrs:{label:"链接",prop:"url"}},[a("el-input",{attrs:{placeholder:"请填写推送标题"},model:{value:t.detailsData.url,callback:function(e){t.$set(t.detailsData,"url",e)},expression:"detailsData.url"}})],1),a("el-form-item",{attrs:{label:"全体推送",prop:"target"}},[a("el-switch",{attrs:{"active-value":"1","inactive-value":"2","active-color":"#ffbe11","inactive-color":"#d9d9d9"},model:{value:t.detailsData.target,callback:function(e){t.$set(t.detailsData,"target",e)},expression:"detailsData.target"}})],1),"2"==t.detailsData.target?a("el-form-item",{attrs:{label:"指定性别："}},[a("el-checkbox-group",{model:{value:t.target_sex,callback:function(e){t.target_sex=e},expression:"target_sex"}},[a("el-checkbox",{attrs:{label:"男"}}),a("el-checkbox",{attrs:{label:"女"}})],1)],1):t._e(),"2"==t.detailsData.target?a("el-form-item",{attrs:{label:"指定系统："}},[a("el-checkbox-group",{model:{value:t.target_os,callback:function(e){t.target_os=e},expression:"target_os"}},[a("el-checkbox",{attrs:{label:"iOS"}}),a("el-checkbox",{attrs:{label:"Android"}})],1)],1):t._e(),a("el-form-item",{attrs:{label:"计划时间："}},[a("el-date-picker",{attrs:{type:"datetime",placeholder:"设置计划推送时间","value-format":"yyyy-MM-dd HH:mm",format:"yyyy-MM-dd HH:mm"},model:{value:t.detailsData.send_time,callback:function(e){t.$set(t.detailsData,"send_time",e)},expression:"detailsData.send_time"}}),t._v(" 注：不填则立即推送 ")],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.insertDialog=!1}}},[t._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.handleInsertData("detailsData")}}},[t._v("确定")])],1)],1),t.searchOption.article_id>0?a("go-back"):t._e()],1)},s=[],r=(a("a9e3"),{name:"SystemPush",data:function(){return{searchOption:{article_id:0,title:"",sort:"",order:"",page:1,start_time:"",end_time:""},searchTime:["",""],detailsDialog:!1,insertDialog:!1,total:1,tableListData:[],detailsData:{push_id:"",title:"",content:"",image:"",url:"",target:"1",target_sex:0,target_os:0,target_ver:"",send_time:""},target_sex:[],target_os:[],rules:{title:[{required:!0,message:"请输入推送标题",trigger:"blur"}],content:[{required:!0,message:"请输入推送内容",trigger:"blur"}],url:[{required:!0,message:"请输入链接",trigger:"blur"}]},loading:!1,sortableList:{ascending:"asc",descending:"desc",asc:"ascending",desc:"descending"},pickerOptions:{shortcuts:[{text:"最近一周",onClick:function(t){var e=new Date,a=new Date;a.setTime(a.getTime()-6048e5),t.$emit("pick",[a,e])}},{text:"最近一个月",onClick:function(t){var e=new Date,a=new Date;a.setTime(a.getTime()-2592e6),t.$emit("pick",[a,e])}},{text:"最近三个月",onClick:function(t){var e=new Date,a=new Date;a.setTime(a.getTime()-7776e6),t.$emit("pick",[a,e])}}]}}},created:function(){this.iniPageParam(),this.getTableList()},watch:{$route:function(t,e){this.iniPageParam(),this.getTableList()}},methods:{iniPageParam:function(){this.searchOption={article_id:this.$route.query.article_id?Number(this.$route.query.article_id):0,title:this.$route.query.title?decodeURIComponent(this.$route.query.title):"",user:this.$route.query.user,sort:this.$route.query.sort,order:this.$route.query.order,page:this.$route.query.page?Number(this.$route.query.page):1,start_time:this.$route.query.start_time,end_time:this.$route.query.end_time},this.searchTime[0]=this.$route.query.start_time?this.$route.query.start_time:"",this.searchTime[1]=this.$route.query.end_time?this.$route.query.end_time:""},insertData:function(){this.insertDialog=!0},handleDataSort:function(t){this.searchOption.sort=t.order?t.prop:"",this.searchOption.order=t.order?this.sortableList[t.order]:"",this.searchOption.page=1,this.pageChange()},handleInsertData:function(t){var e=this;this.$refs[t].validate((function(a){if(!a)return console.log("error submit!!"),!1;e.$confirm("确定要提交推送吗？","提示").then((function(){e.insertDataOk(t)}))}))},insertDataOk:function(t){var e=this,a=!0,i="";if("2"==this.detailsData.target&&(0==this.target_sex.length?(a=!1,i="必须至少指定一个性别"):0==this.target_os.length?(a=!1,i="必须至少指定一个系统"):(1==this.target_sex.length?this.detailsData.target_sex="男"==this.target_sex[0]?"1":"2":this.detailsData.target_sex="0",1==this.target_os.length?this.detailsData.target_os="iOS"==this.target_os[0]?"1":"2":this.detailsData.target_os="0")),a){var s=this.detailsData;delete s.push_id,delete s.image,s.target=Number(this.detailsData.target),s.target_sex=Number(this.detailsData.target_sex),s.target_os=Number(this.detailsData.target_os),this.api.system.SystemPushInsert(s).then((function(t){var a=t.data,i=a;e.$message({message:""+i.msg,type:"success"}),e.$router.push({path:"/Notification/systemPush"}),e.insertDialog=!1}))}else this.$message.error(i)},dateChange:function(t){t&&(this.searchOption.start_time=t[0],this.searchOption.end_time=t[1])},resetData:function(){this.searchOption={title:"",sort:"",order:"",page:1,start_time:"",end_time:""},this.searchTime=["",""],this.pageChange()},screening:function(){this.searchOption.page=1,this.pageChange()},getTableList:function(){var t=this,e=this.searchOption;this.api.system.SystemPush(e).then((function(e){t.loading=!1,0==e.data.data.length&&t.searchOption.article_id>0&&t.$message("没有找到推送记录，请返回查看其它数据。"),t.tableListData=e.data.data,t.total=e.data.count,t.$refs.pagination.internalCurrentPage=t.searchOption.page})).catch((function(){t.loading=!1}))},detailsDelDialog:function(t){this.detailsData=t,this.detailsDialog=!0},pageChange:function(t){t&&(this.searchOption.page=t),this.searchTime||(this.searchTime=["",""],this.searchOption.start_time=this.searchTime[0],this.searchOption.end_time=this.searchTime[1]),this.searchOption.title=this.searchOption.title?encodeURIComponent(this.searchOption.title):"",this.$router.push({path:"/Notification/systemPush",query:this.searchOption})}}}),l=r,n=(a("5204"),a("2877")),o=Object(n["a"])(l,i,s,!1,null,"552a5419",null);e["default"]=o.exports},"787d":function(t,e,a){}}]);
//# sourceMappingURL=chunk-2c8333db.90687421.js.map